<hr />

<div class="panel panel-default" ng-repeat="test in data.results"
     ng-class="cssStatusClass(test)">
  <div class="panel-heading">
    <div ng-click="test.show = !test.show" class="toggle">
      {{ test.metadata.description }}
    </div>

    <div class="conflict" ng-show="test.conflict">
      <span class="text">
      	Conflict with status "{{ test.conflict.old_status }}"
      	by "{{ test.conflict.user.username }}"
      </span>
      <button type="button" class="btn btn-sm btn-warning"
	      ng-click="forceSetStatus(test, test.conflict.new_status)">
      	Proceed?
      </button>
    </div>

    <div ng-hide="test.conflict">
      <span ng-show="test.modified_by">
	by <b>{{ test.modified_by.username }}</b>
      </span>

      <div class="btn-group" role="group">
      	<div class="btn-group btn-group-sm" role="group">
      	  <button type="button" class="btn btn-success"
      		  ng-class="{'active': test.status == 'pass'}"
      		  ng-click="setStatus(test, 'pass')">Pass</button>
      	</div>
      	<div class="btn-group btn-group-sm" role="group">
      	  <button type="button" class="btn btn-warning"
      		  ng-class="{'active': test.status == 'skip'}"
      		  ng-click="setStatus(test, 'skip')">Skip</button>
      	</div>
      	<div class="btn-group btn-group-sm" role="group">
      	  <button type="button" class="btn btn-danger"
      		  ng-class="{'active': test.status == 'fail'}"
      		  ng-click="setStatus(test, 'fail')">Fail</button>
      	</div>
      </div>

      <div class="btn-group" role="group" ng-hide="true">
	<div class="btn-group btn-group-sm" role="group">
      	  <button type="button" class="btn btn-success"
      		  ng-class="{'active': test.status == 'pass'}"
      		  ng-click="setStatus(test, 'pass')">Pass</button>
	</div>
	<div class="btn-group btn-group-sm" role="group">
      	  <button type="button" class="btn btn-warning"
      		  ng-class="{'active': test.status == 'skip'}"
      		  ng-click="setStatus(test, 'skip')">Skip</button>
	</div>
	<div class="btn-group btn-group-sm" role="group">
      	  <button type="button" class="btn btn-danger"
      		  ng-class="{'active': test.status == 'fail'}"
      		  ng-click="setStatus(test, 'fail')">Fail</button>
	</div>
      </div>
    </div>

  </div>
  <div class="panel-body" ng-show="test.show">
    <div class="row">
      <div class="col-xs-8">
	<ol>
	  <li ng-repeat="step in test.steps">{{ step }}</li>
	</ol>

	<hr/>
	<ol>
	  <li ng-repeat="step in test.expected">{{ step }}</li>
	</ol>
      </div>
      <div class="col-xs-4 bugs">

	<div class="input-group">
	  <input type="text" class="form-control input-sm">
	  <div class="input-group-btn">
	    <span uib-dropdown is-open="status.isopen">
	      <button type="button" class="btn btn-sm btn-primary" uib-dropdown-toggle>
	    	{{ selected.verbose_name || 'type' }} <span class="caret"></span>
	      </button>

	      <ul uib-dropdown-menu role="menu" aria-labelledby="single-button" ng-mode=>

	    	<li role="menuitem" ng-repeat="source in issueSources">
		  <a href="" ng-click="selectIssueKind(source)" >{{ source.verbose_name }}</a>
		</li>
	      </ul>
	    </span>

	    <button type="button" class="btn btn-sm btn-default">
	      <i class="fa fa-plus-circle"></i>
	    </button>
	  </div>
	</div>

      </div>
    </div>
  </div>
</div>

<progress class="bottom" results="data.results"></progress>
